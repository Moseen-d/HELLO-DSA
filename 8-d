#include<stdio.h>
#include<stdlib.h>
#define MAX 4

struct emp {
    char ssn[10], name[10], dept[10];
    int salary;
    struct emp *right, *left;
};
typedef struct emp NODE;

int count = 0;

NODE *getnode()
{
    NODE *nw = (NODE *)malloc(sizeof(NODE));
    printf("enter SSN NAME DEPT SALARY\n");
    scanf("%s %s %s %d", nw->ssn, nw->name, nw->dept, &nw->salary);
    nw->right = nw->left = NULL;
    return nw;
}

NODE *in_front(NODE *head)
{
    if(count == MAX)
    {
        printf("full\n");
        return head;
    }

    NODE *nw = getnode();

    if(head != NULL)
    {
        nw->right = head;
        head->left = nw;
    }

    count++;
    return nw;
}

NODE *in_rear(NODE *head)
{
    if(count == MAX)
    {
        printf("full\n");
        return head;
    }

    NODE *nw = getnode();

    if(head == NULL)
    {
        count++;
        return nw;
    }

    NODE *p = head;
    while(p->right != NULL)
    {
        p = p->right;
    }

    p->right = nw;
    nw->left = p;
    count++;
    return head;
}

NODE *del_front(NODE *head)
{
    if(count == 0)
    {
        printf("empty\n");
        return head;
    }

    NODE *p = head;
    head = head->right;

    if(head != NULL)
        head->left = NULL;

    free(p);
    count--;
    return head;
}

NODE *del_rear(NODE *head)
{
    if(count == 0)
    {
        printf("empty\n");
        return head;
    }

    if(head->right == NULL)
    {
        free(head);
        count--;
        return NULL;
    }

    NODE *p = head;
    while(p->right != NULL)
    {
        p = p->right;
    }

    p->left->right = NULL;
    free(p);
    count--;
    return head;
}

void display(NODE *head)
{
    if(count == 0)
    {
        printf("empty\n");
        return;
    }

    NODE *p = head;
    printf("\nSSN NAME DEPT SALARY\n");
    while(p != NULL)
    {
        printf("%s %s %s %d\n",
               p->ssn, p->name, p->dept, p->salary);
        p = p->right;
    }
}

int main()
{
    int ch;
    NODE *head = NULL;

    do {
        printf("\n1.insert front 2.insert rear 3.del front 4.del rear 5.display 6.exit\n");
        printf("enter your choice : ");
        scanf("%d", &ch);

        switch(ch)
        {
            case 1: head = in_front(head); break;
            case 2: head = in_rear(head); break;
            case 3: head = del_front(head); break;
            case 4: head = del_rear(head); break;
            case 5: display(head); break;
            case 6: exit(0);
        }
    } while(ch != 6);

    return 0;
}
