#include<stdio.h>
#include<stdlib.h>

#define MAX 4

struct student
{
    char usn[10], name[20], branch[10], ph[12];
    int sem;
    struct student *next;
};
typedef struct student NODE;

int count = 0;

/* Create new node */
NODE* getnode()
{
    NODE *newn = (NODE*)malloc(sizeof(NODE));
    printf("\nEnter USN Name Branch Sem Phone: ");
    scanf("%s %s %s %d %s", newn->usn, newn->name,
          newn->branch, &newn->sem, newn->ph);
    newn->next = NULL;
    return newn;
}

/* Insert at front (PUSH for stack) */
NODE* insert_front(NODE *head)
{
    if(count == MAX)
    {
        printf("List Full\n");
        return head;
    }
    NODE *newn = getnode();
    newn->next = head;
    head = newn;
    count++;
    return head;
}

/* Insert at rear (INSERT for queue) */
NODE* insert_rear(NODE *head)
{
    if(count == MAX)
    {
        printf("List Full\n");
        return head;
    }

    NODE *newn = getnode();

    if(head == NULL)
    {
        count++;
        return newn;
    }

    NODE *p = head;
    while(p->next != NULL)
        p = p->next;

    p->next = newn;
    count++;
    return head;
}

/* Delete front (POP for stack, DELETE for queue) */
NODE* delete_front(NODE *head)
{
    if(head == NULL)
    {
        printf("List Empty\n");
        return head;
    }
    NODE *temp = head;
    head = head->next;
    printf("Deleted: %s\n", temp->usn);
    free(temp);
    count--;
    return head;
}

/* Delete rear */
NODE* delete_rear(NODE *head)
{
    NODE *p, *q;

    if(head == NULL)
        return head;

    if(head->next == NULL)
    {
        free(head);
        return NULL;
    }

    p = head;

    while(p->next != NULL)
    {
        q = p;
        p = p->next;
    }

    free(p);
    q->next = NULL;

    printf("\nLast(end) entry is deleted");
    return head;
}

/* Display */
void display(NODE *head)
{
    NODE *p = head;
    if(head == NULL)
    {
        printf("No data\n");
        return;
    }

    printf("\nUSN  NAME  BRANCH  SEM  PHONE\n");
    while(p != NULL)
    {
        printf("%s %s %s %d %s\n",
               p->usn, p->name, p->branch, p->sem, p->ph);
        p = p->next;
    }
}

/* Stack Menu */
NODE* stack(NODE *head)
{
    int ch;
    do
    {
        printf("\nSTACK MENU\n1.PUSH\n2.POP\n3.EXIT\n");
        scanf("%d",&ch);
        switch(ch)
        {
            case 1: head = insert_front(head); break;
            case 2: head = delete_front(head); break;
        }
        display(head);
    } while(ch != 3);

    return head;
}

/* Queue Menu */
NODE* queue(NODE *head)
{
    int ch;
    do
    {
        printf("\nQUEUE MENU\n1.INSERT\n2.DELETE\n3.EXIT\n");
        scanf("%d",&ch);
        switch(ch)
        {
            case 1: head = insert_rear(head); break;
            case 2: head = delete_front(head); break;
        }
        display(head);
    } while(ch != 3);

    return head;
}

/* Main */
void main()
{
    NODE *head = NULL;
    int ch;

    while(1)
    {
        printf("\n1.Insert Front\n2.Insert Rear\n3.Delete Front\n4.Delete Rear");
        printf("\n5.Display\n6.Stack\n7.Queue\n8.Exit\n");
        scanf("%d",&ch);

        switch(ch)
        {
            case 1: head = insert_front(head); break;
            case 2: head = insert_rear(head); break;
            case 3: head = delete_front(head); break;
            case 4: head = delete_rear(head); break;
            case 5: display(head); break;
            case 6: head = stack(head); break;
            case 7: head = queue(head); break;
            case 8: exit(0);
        }
    }
}
