#include<stdio.h>
#include<stdlib.h>

#define MAX 4

struct student
{
    char usn[10], name[20], branch[10], ph[12];
    int sem;
    struct student *next;
};
typedef struct student NODE;

int count = 0;

/* Create node */
NODE* getnode()
{
    NODE *n = (NODE*)malloc(sizeof(NODE));
    printf("Enter USN Name Branch Sem Phone:\n");
    scanf("%s %s %s %d %s", n->usn, n->name, n->branch, &n->sem, n->ph);
    n->next = NULL;
    return n;
}

/* Insert Front */
NODE* insert_front(NODE *head)
{
    if(count == MAX)
    {
        printf("List Full\n");
        return head;
    }
    NODE *n = getnode();
    n->next = head;
    count++;
    return n;
}

/* Insert Rear */
NODE* insert_rear(NODE *head)
{
    if(count == MAX)
    {
        printf("List Full\n");
        return head;
    }

    NODE *n = getnode();

    if(head == NULL)
    {
        count++;
        return n;
    }

    NODE *p = head;
    while(p->next != NULL)
        p = p->next;

    p->next = n;
    count++;
    return head;
}

/* Delete Front */
NODE* delete_front(NODE *head)
{
    if(head == NULL)
    {
        printf("List Empty\n");
        return head;
    }

    NODE *temp = head;
    head = head->next;
    printf("Deleted: %s\n", temp->usn);
    free(temp);
    count--;
    return head;
}

/* Delete Rear */
NODE* delete_rear(NODE *head)
{
    NODE *p, *q;

    if(head == NULL)
    {
        printf("List Empty\n");
        return head;
    }

    if(head->next == NULL)
    {
        free(head);
        count--;
        return NULL;
    }

    p = head;
    while(p->next != NULL)
    {
        q = p;
        p = p->next;
    }

    q->next = NULL;
    free(p);
    count--;
    return head;
}

/* Display */
void display(NODE *head)
{
    if(head == NULL)
    {
        printf("No Data\n");
        return;
    }

    NODE *p = head;
    printf("\nUSN NAME BRANCH SEM PHONE\n");
    while(p != NULL)
    {
        printf("%s %s %s %d %s\n",
               p->usn, p->name, p->branch, p->sem, p->ph);
        p = p->next;
    }
}

/* Stack */
NODE* stack(NODE *head)
{
    int ch;
    do
    {
        printf("\nSTACK MENU\n1.PUSH\n2.POP\n3.EXIT\n");
        scanf("%d",&ch);
        switch(ch)
        {
            case 1: head = insert_front(head); break;
            case 2: head = delete_front(head); break;
        }
        display(head);
    } while(ch != 3);

    return head;
}

/* Queue */
NODE* queue(NODE *head)
{
    int ch;
    do
    {
        printf("\nQUEUE MENU\n1.INSERT\n2.DELETE\n3.EXIT\n");
        scanf("%d",&ch);
        switch(ch)
        {
            case 1: head = insert_rear(head); break;
            case 2: head = delete_front(head); break;
        }
        display(head);
    } while(ch != 3);

    return head;
}

/* Main */
int main()
{
    NODE *head = NULL;
    int ch;

    while(1)
    {
        printf("\n1.Insert Front\n2.Insert Rear\n3.Delete Front\n4.Delete Rear");
        printf("\n5.Display\n6.Stack\n7.Queue\n8.Exit\n");
        scanf("%d",&ch);

        switch(ch)
        {
            case 1: head = insert_front(head); break;
            case 2: head = insert_rear(head); break;
            case 3: head = delete_front(head); break;
            case 4: head = delete_rear(head); break;
            case 5: display(head); break;
            case 6: head = stack(head); break;
            case 7: head = queue(head); break;
            case 8: exit(0);
        }
    }
}
